\makeatletter

\def\nx@optionalMany{pp}
\def\nx@optionalOne{oo}
\def\nx@mandatoryMany{mm}
\def\nx@mandatoryOne{nn}
\def\nx@true{1}
\def\nx@false{0}
\def\nx@default{ ~}%

\def\nx@crowsfootmm#1#2{%
	\ifx#1\nx@mandatoryMany%
		\ifx#2\nx@true%
			\draw[thick] (-0.3,0) -- (0.0,0.2)
				(-0.3,0) -- (0.0,-0.2)
				(-0.3,0.2) -- (-0.3,-0.2);
		\else\ifx#2\nx@false%
			\draw[thick]
				(0.3,0) -- (0.0,0.2)
				(0.3,0) -- (0.0,-0.2)
				(0.3,0.2) -- (0.3,-0.2);
		\fi\fi%
	\fi%
}

\def\nx@crowsfootnn#1#2{%
	\ifx#1\nx@mandatoryOne%
		\ifx#2\nx@true%
			\draw[thick] (-0.2,0.2) -- (-0.2,-0.2)
				(-0.1,0.2) -- (-0.1,-0.2);
		\else\ifx#2\nx@false%
			\draw[thick] (0.2,0.2) -- (0.2,-0.2)
				(0.1,0.2) -- (0.1,-0.2);
		\fi\fi%
	\fi%
}

\def\nx@crowsfootpp#1#2{%
	\ifx#1\nx@optionalMany%
		\ifx#2\nx@true%
			\draw[thick, fill=white]
				(-0.4,0) circle[radius=1mm]
				(-0.3,0) -- (0.0,0.2)
				(-0.3,0) -- (0.0,-0.2);
		\else\ifx#2\nx@false%
			\draw[thick, fill=white]
				(0.4,0) circle[radius=1mm]
				(0.3,0) -- (0.0,0.2)
				(0.3,0) -- (0.0,-0.2);
		\fi\fi%
	\fi%
}

\def\nx@crowsfootoo#1#2{%
	\ifx#1\nx@optionalOne%
		\ifx#2\nx@true%
			\draw[thick, fill=white]
				(-0.3,0) circle[radius=1mm] (-0.3,-0.2)
				(-0.1,0.2) -- (-0.1,-0.2);
		\else\ifx#2\nx@false%
			\draw[thick, fill=white]
				(0.3,0) circle[radius=1mm] (0.3,-0.2)
				(0.1,0.2) -- (0.1,-0.2);
		\fi\fi%
	\fi%
}

\tikzset{%
	line/.style={%
		draw,%
		-{Latex}%
	},%
	startstop/.style={%
		ellipse,%
		draw,%
		fill=red!20,%
		text centered,%
		minimum height=2em%
	},%
	process/.style={%
		rectangle,%
		draw,%
		fill=blue!20,%
		text centered,%
		minimum height=2em%
	},%
	decision/.style={%
		diamond,%
		draw, fill=green!20,%
		text centered,%
		aspect=2%
	},%
	io/.style={%
		trapezium,%
		trapezium left angle=70,%
		trapezium right angle=110,%
		draw,%
		fill=orange!20,%
		text centered%
	},%
	terminator/.style={%
		rounded rectangle,%
		draw, fill=purple!20,%
		text centered,%
		minimum height=2em%
	},%
	labeltop/.style={%
		above,%
		font=\small\itshape%
	},%
	labelbottom/.style={%
		below,%
		font=\small\ttfamily%
	},%
	labelleft/.style={%
		left,%
		font=\scriptsize%
	},%
	labelright/.style={%
		right,%
		font=\scriptsize\bfseries%
	},%
	/nx/.cd,%
	dash/.style={%
		thick,%
		dashed,%
		dash pattern=on 2pt off 1pt%
	},%
	crowsfoot/.style n args={2}{%
			postaction={%
				decorate,%
				decoration={%
					markings,%
					mark=at position 0 with {\pgfextra{\expandafter\csname nx@crowsfoot#1\endcsname{#1}{\nx@false}}},%
					mark=at position 1 with {\pgfextra{\expandafter\csname nx@crowsfoot#2\endcsname{#2}{\nx@true}}}%
			}
		}
	},
	/nx/.cd
	logic gates/.cd,%
	and/.style={%
			and port,%
			logic gate inputs={#1},%
			fill=blue!10%
	},%
	nand/.style={%
		nand port,%
		logic gate inputs={#1},%
		fill=purple!10%
	},%
	or/.style={%
		or port,%
		logic gate inputs={#1},%
		fill=yellow!10%
	},%
	nor/.style={%
		nor port,%
		logic gate inputs={#1},%
		fill=green!10%
	},%
	xor/.style={%
		xor port,%
		logic gate inputs={#1},%
		fill=gray!10%
	},%
	xnor/.style={%
		xnor port,%
		inputs={#1},%
		logic gate inputs={#1},%
		fill=brown!10%
	},%
	buf/.style={%
		buffer port,%
		fill=green!10%
	},%
	not/.style={%
		not port,%
		fill=red!10%
	}%
}

\long\def\nxCoverPage[#1]{%
	\pgfkeys{%
		nx cover page,%
		title,%
		author,%
		ref,
		abstract,%
		image,%
		#1%
	}%
	\def\nx@ref{\pgfkeysvalueof{/nx/cover page/ref}}
	\begin{tikzpicture}[remember picture, overlay]
		\shade[
			right color=nex.danger.back,%
			left color=nex.dark.back,%
			draw=nex.danger.frame,%
			ultra thick,%
		] (current page.north west) -| (current page.south east) -| (current page.north west);
		\node[%
			circle,%
			outer color=nex.dark.back,%
			inner color=nex.warning.back,%
			minimum width=0.7\pagewidth,%
			circular drop shadow={%
				shadow scale=1.05%
			},%
			draw=nex.warning.frame,%
			ultra thick,%
			postaction={%
				decorate,%
				decoration={%
					raise=2mm,
					text along path,%
					text align={align=center},%
					text color=nex.warning.text,%
					text={\today}
				}
			}
		] (logo) at (current page.center) {};
		\node at (current page.center) {\includegraphics[width=0.6\pagewidth]{\nx@image}};
		\node[above=of logo, text=nex.danger.text, yshift=1cm] (title) {\nxSFont{36pt} \bf \nx@title};
		\node[below=of logo, text=nex.danger.text, yshift=-1cm] (author) {\nxSFont{24pt} \bf \nx@author};
		\node[below=of author, text=nex.primary.text] (link) {\nxSFont{24pt} \href{\nx@link}{\bf \nx@ref}};
	\end{tikzpicture}
	\newpage
	\expandafter\ifx\nx@abstract\relax\else
		\begin{tcolorbox}[nxCol=light, sdwA]
			\begin{tcolorbox}[nxCol=light, title={\bf \nx@Abstract}, hdrD, sdwA]
				\nx@abstract
			\end{tcolorbox}
		\end{tcolorbox}
		\bigskip
	\fi
}

\def\nxSnowFade{%
	\AddToShipoutPictureBG{%
		\AtPageLowerLeft{%
			\begin{tikzpicture}[remember picture, overlay]
				\expandafter\shade\expandafter[%
					top color={\ifodd\the\count0 nex.page.top\else nex.page.bottom\fi},
					middle color=nex.page.middle,%
					bottom color={\ifodd\the\count0 nex.page.bottom\else nex.page.top\fi},
				](current page.south west) rectangle (current page.north east);
			\end{tikzpicture}
		}
	}
}

\begin{comment}
\ctikzset{%
	logic ports/scale=1.2,%
	logic ports/label/.style={font=\small\ttfamily},%
	logic ports/input anchors=1,2,%
	logic ports/output anchor=out%
}
\pgfarrowsdeclare{crowsfoot}{crowsfoot}
{
	\pgfarrowsleftextend{-2pt}
	\pgfarrowsrightextend{7pt}
	\pgfarrowsuptextend{2.5pt}
	\pgfarrowsdowntextend{-2.5pt}
}
{
	\pgfsetlinewidth{0.6pt}
	\pgfpathmoveto{\pgfpoint{0pt}{0pt}}
	\pgfpathlineto{\pgfpoint{6pt}{0pt}}
	\pgfpathmoveto{\pgfpoint{0pt}{0pt}}
	\pgfpathlineto{\pgfpoint{6pt}{2pt}}
	\pgfpathmoveto{\pgfpoint{0pt}{0pt}}
	\pgfpathlineto{\pgfpoint{6pt}{-2pt}}
	\pgfarrowsdrawline
}
\end{comment}

\makeatother
