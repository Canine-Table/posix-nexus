\pagestyle{fancy}
\pgfplotsset{compat=1.18}
\tcbuselibrary{minted, vignette}
\usetikzlibrary{decorations.fractals, patterns, positioning, arrows.meta}
\renewcommand{\headrulewidth}{0.4pt}\renewcommand{\footrulewidth}{0.4pt}
\nxNoParIndent\nxSnowFlakeHeader\nxRomainFooter\fancyhead{}
\titleformat{\section}[block]{\Large\bfseries}{\thesection}{1em}{}
\titleformat{\subsection}[block]{\large\bfseries}{\thesubsection}{1em}{}
\titleformat{\subsubsection}[block]{\normalsize\bfseries}{\thesubsubsection}{1em}{}
\fancyfoot[LE,RO]{\textsl{\rightmark}}\fancyfoot[LO,RE]{\textsl{\leftmark}}
\setlength{\headheight}{20.97897pt}
\renewcommand{\contentsname}{}
\AddToShipoutPictureBG{%
	\AtPageLowerLeft{%
		\begin{tikzpicture}[remember picture, overlay]
			\expandafter\shade\expandafter[%
				top color={\ifodd\the\count0 nex.page.bottom\else nex.page.top\fi},
				middle color=nex.page.middle,%
				bottom color={\ifodd\the\count0 nex.page.top\else nex.page.bottom\fi},
			](current page.south west) rectangle (current page.north east);
		\end{tikzpicture}
	}
}

\NewDocumentCommand{\nxLnk}{O{} O{Canine-Table} O{Contents} O{}}{
	\global\def\nxS{#3}
	\fancyhead[LO, RE]{%
		\tcbox[on line, size=fbox]{\hyperref[sec:\nxS]{\textcolor{nex.primary.back}{\bf Posix-Nexus}}}\hspace{5pt}%
		\tcbox[on line, size=fbox]{\hyperref[sec:#3]{\textcolor{nex.primary.back}{\bf#1}}}%
	}
	\hypersetup{
		linktoc=all,
		colorlinks=true,
		linkcolor=nex.primary.back,
		pdfborder={0 0 0},
		pdftitle={Posix-Nexus #1},
		pdfauthor={#2},
		pdfsubject={Posix-Nexus #1},
		pdfkeywords={\nxEmpty{#4}{#1}{#4}}
	}
}

\NewDocumentCommand{\nxTitle}{O{}O{}O{}O{../lib/svg/}O{Canine-Table}O{Contents}}{%
	\title{
		\hspace{\nxEmpty{#2}{0pt}{48pt}}{\bf Posix-Nexus #1}\nxEmpty{#2}{}{\includesvg[width=48px]{#4#2}}\\[10mm]
		\begin{NxMainBox}[dark, shpA,fit, width=\linewidth/2]
			\includegraphics[width=\textwidth]{img/posix-nexus.png}
		\end{NxMainBox}
		\begin{tikzpicture}% draw two balls
			\path[use as bounding box] (0,0.4) rectangle +(0.1,0.1);
			\shadedraw [shading=ball] (-9.6,6.2) circle (1.4cm);
			\shadedraw [ball color=green] (-9,10) circle (2.1cm);
			\shadedraw [ball color=yellow] (-8.4,15.4) circle (3cm);
			\shadedraw [ball color=red] (-10.2,3.5) circle (1cm);
		\end{tikzpicture}
	}
	\author{\bf#5}
	\date{\bf\today}
	\maketitle
	\begin{NxMainBox}[light, title=\textbf{Abstract}, sdwA, center title]
		\begin{NxMainBox}[light, title={\bf\LARGE #1 Edition}, hdrD, sdwA]
			#3
		\end{NxMainBox}
	\end{NxMainBox}
	\newpage
	\phantomsection{}\label{sec:#6}
	\begin{NxMainBox}[light, title={\bf#6}, hdrB, breakable, sdwA]
		\thispagestyle{plain}
		\tableofcontents
	\end{NxMainBox}
	\newpage
}


