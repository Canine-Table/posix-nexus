\documentclass[a4paper,12pt]{article}
\RequirePackage{ifluatex} % Checks if the document is compiled with LuaLaTeX
\ifluatex%
	\usepackage{luacode} % Allows embedding Lua code directly in LaTeX
	\edef\nxPath{\directlua{tex.sprint(os.getenv('G_NEX_MOD_LIB') .. "/lua/lualatex")}}
	\message{Posix-Nexus LuaLaTeX preamble fully loaded!}
\else%
	\PackageError{luacode}{LuaTeX is required, but not detected}{}%
\fi%


\begin{document}
\documentclass[a4paper,12pt]{article}
\end{document}
